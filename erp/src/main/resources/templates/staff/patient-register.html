<!-- src/main/resources/templates/patient-register.html -->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>í™˜ì ë“±ë¡ ë° ìˆ˜ì •</title>
  <link rel="stylesheet" href="/css/erp-common.css" />
  <style>
    /* ê³µí†µ ë°°ê²½ */
    body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', 'ë§‘ì€ ê³ ë”•', sans-serif;
      background-color: #D5DDED;
    }

    /* ìƒë‹¨ í—¤ë” ë°°ê²½ ë° ë ˆì´ì•„ì›ƒ */
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 5px 15px;
      background-color: #ffffff;
      font-size: 14px;
    }

    .user-info { color: #555; }

    .action-buttons {
      display: flex;
      gap: 5px;
    }

    .action-buttons button {
      padding: 4px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      font-size: 13px;
      border: 1px solid #7B7B7B;
    }

    .btn-logout {
      padding: 4px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      font-size: 13px;
      color: white;
      background-color: #FF4B4B;
      border: 1px solid #7B7B7B;
    }

    .time-in {
      background-color: #879BD5;
      color:#ffffff;
    }

    .time-out {
      background-color: #D5DDED;
      color: #000;
    }

    .tab-list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
    }

    .tab-item a {
      display: block;
      padding: 8px 15px;
      text-decoration: none;
      color: #333;
      background-color: transparent;
      border: none;
      font-size: 14px;
      font-weight: normal;
    }

    .nav-tabs {
      background-color: #D5DDED;
      padding: 0 10px;
    }

    .tab-item:hover {
      background-color: rgba(255, 255, 255, 0.3);
    }

    .tab-item.active a {
      color: #333;
      font-weight: 550;
    }

    .sub-menu {
      background-color: #BACCFF;
      padding: 5px 15px;
      font-size: 14px;
      color: #555;
      font-weight: 530;
    }

    .content-area {
      min-height: 700px;
      background-color: #D5DDED;
    }

    /* ============================
       í™˜ì ë“±ë¡ ë° ìˆ˜ì • ì „ìš© ë ˆì´ì•„ì›ƒ
       ============================ */

    .layout-two-column {
      display: flex;
      gap: 12px;
      padding: 10px;
      box-sizing: border-box;
    }

    .left-panel {
      flex: 2.5;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .right-panel {
      flex: 1.2;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .search-row {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .search-box {
      flex: 1;
      display: flex;
      align-items: center;
      background: #ffffff;
      border-radius: 999px;
      border: 1px solid #b0b7c7;
      padding: 4px 10px;
    }

    .search-box input {
      border: none;
      outline: none;
      font-size: 13px;
      flex: 1;
    }

    .search-icon {
      margin-right: 4px;
      color: #9ca3af;
    }

    .btn-small {
      padding: 5px 12px;
      font-size: 13px;
      border-radius: 4px;
      border: 1px solid #7B7B7B;
      background-color: #879BD5;
      color: #fff;
      cursor: pointer;
    }

    .patient-table-box {
      border: 1px solid #b0b7c7;
      border-radius: 4px;
      overflow: hidden;
      background-color: #ffffff;
      height: 520px;
      box-sizing: border-box;
    }

    .patient-table-box table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    .patient-table-box thead tr {
      background-color: #f3f6ff;
    }

    .patient-table-box th,
    .patient-table-box td {
      border: 1px solid #d1d5db;
      padding: 4px 6px;
      text-align: left;
    }

    .patient-table-box tbody tr:nth-child(even) {
      background-color: #fafbff;
    }

    .card {
      border: 1px solid #b0b7c7;
      border-radius: 4px;
      background-color: #f7f9ff;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 10px;
      font-size: 13px;
      font-weight: 600;
      background-color: #BACCFF;
    }

    .card-header.blue {
      background-color: #879BD5;
      color: #ffffff;
    }

    .card-body {
      padding: 8px 10px;
      background-color: #ffffff;
    }

    .form-row {
      display: flex;
      align-items: center;
      margin-bottom: 6px;
      gap: 6px;
      font-size: 13px;
    }

    .form-row label {
      width: 65px;
      color: #333;
    }

    .form-row input {
      flex: 1;
      padding: 4px 6px;
      font-size: 13px;
      border-radius: 3px;
      border: 1px solid #cbd2e1;
      box-sizing: border-box;
    }

    .right-top-row {
      display: flex;
      justify-content: flex-end;
    }

    .btn-new {
      padding: 6px 14px;
      font-size: 13px;
      border-radius: 4px;
      border: 1px solid #7B7B7B;
      background-color: #879BD5;
      color: #ffffff;
      cursor: pointer;
    }

    .btn-xs {
      padding: 4px 10px;
      font-size: 12px;
      border-radius: 4px;
      border: 1px solid #7B7B7B;
      background-color: #D5DDED;
      cursor: pointer;
    }

    .quick-buttons {
      display: flex;
      gap: 6px;
    }

    .quick-buttons .btn-small {
      flex: 1;
      text-align: center;
    }

    .card-body table {
      width: 100%;
      font-size: 12px;
    }

    .erp-page {
      width: 1280px;
      margin: 24px auto;
      background: #ffffff;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
  </style>
</head>
<body>
<div class="erp-page">
  <header class="main-header">
    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="top-bar">
      <div class="user-info">
        <span>(ì•„ì´ì½˜)</span>
        <span>MediCare |</span>
        <span>ì‚¬ìš©ìID: </span>
      </div>
      <div class="user-info">
        <span>ì§„ë£Œê³¼ ã…‡ã…‡ã…‡</span>
        <button class="btn-logout">ë¡œê·¸ì•„ì›ƒ</button>
      </div>
      <div class="action-buttons">
        <button class="time-in">ì¶œê·¼</button>
        <button class="time-out">í‡´ê·¼</button>
      </div>
    </div>

    <!-- ì¤‘ì•™ í—¤ë”-->
    <nav class="nav-tabs">
      <ul class="tab-list">
        <li class="tab-item active"><a href="#">í™˜ì ë“±ë¡ ë° ìˆ˜ì •</a></li>
        <li class="tab-item"><a href="#">ì ‘ìˆ˜</a></li>
        <li class="tab-item"><a href="#">ì˜ˆì•½ ë°›ê¸°</a></li>
        <li class="tab-item"><a href="#">ìˆ˜ë‚©</a></li>
        <li class="tab-item"><a href="#">íœ´ê°€ ì‹ ì²­</a></li>
        <li class="tab-item"><a href="#">ìŠ¤ì¼€ì¤„ ì¡°íšŒ</a></li>
      </ul>
    </nav>

    <!-- í•˜ë‹¨ í—¤ë”-->
    <div class="sub-menu">
      <span>í™˜ì ë“±ë¡ ë° ìˆ˜ì •</span>
    </div>
  </header>

  <!-- ë©”ì¸ ì½˜í…ì¸  -->
  <div class="content-area">
    <div class="layout-two-column">
      <!-- ì™¼ìª½: ê²€ìƒ‰ + í™˜ì ë¦¬ìŠ¤íŠ¸ -->
      <section class="left-panel">
        <!-- ê²€ìƒ‰ ì˜ì—­ -->
        <div class="search-row">
          <div class="search-box">
            <span class="search-icon">ğŸ”</span>
            <input type="text" placeholder="í™˜ì ê²€ìƒ‰" />
          </div>
          <button class="btn-small">ì¡°íšŒ</button>
        </div>

        <!-- í™˜ì ë¦¬ìŠ¤íŠ¸ í…Œì´ë¸” -->
        <div class="patient-table-box">
          <table>
            <thead>
            <tr>
              <th>í™˜ìID</th>
              <th>í™˜ìëª…</th>
              <th>ì„±ë³„</th>
              <th>ìƒë…„ì›”ì¼</th>
              <th>ìµœì¢… ë‚´ì›ì¼</th>
              <th>ë©”ëª¨</th>
              <th>íœ´ëŒ€ì „í™”</th>
              <th>ì„ íƒ ê²€ì‚¬ ìƒíƒœ</th>
            </tr>
            </thead>
            <tbody>
            <!-- ì‹¤ì œ í™˜ì ë¦¬ìŠ¤íŠ¸ -->
            <tr th:each="p : ${patients != null ? patients : {}}">
              <td th:text="${p.patientId}">P0001</td>
              <td th:text="${p.name}">í™ê¸¸ë™</td>
              <td th:text="${p.gender}">M</td>
              <td th:text="${p.birth}">2000.01.01</td>
              <td th:text="${p.lastVisit}">2025.01.01</td>
              <td th:text="${p.memo}">ì—†ìŒ</td>
              <td th:text="${p.phone}">010-0000-0000</td>
              <td>
                <span th:text="${p.examStatus}">í•´ë‹¹ ì—†ìŒ</span>
                <!-- ìƒì„¸ì •ë³´ ë²„íŠ¼ -->
                <button type="button"
                        class="btn-xs"
                        style="margin-left:4px;"
                        th:onclick="|location.href='@{/patients(mode=${'detail'}, patientId=${p.patientId})}'|">
                  ìƒì„¸ì •ë³´
                </button>
              </td>
            </tr>

            <!-- ë¹ˆ ì¤„ ì±„ìš°ê¸° -->
            <tr th:with="count=${patients != null ? patients.size() : 0}"
                th:each="i : ${#numbers.sequence(1, 20 - (patients != null ? patients.size() : 0))}">
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
            </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- ì˜¤ë¥¸ìª½: í™˜ì ì •ë³´ + history -->
      <section class="right-panel">
        <!-- ìƒë‹¨: ì‹ ê·œ ë“±ë¡ ë²„íŠ¼ -->
        <div class="right-top-row">
          <button class="btn-new" type="button"
                  th:onclick="|location.href='@{/patients(mode=${'register'})}'|">
            ì‹ ê·œ ë“±ë¡
          </button>
        </div>

        <!-- í™˜ì ì •ë³´ ì¹´ë“œ -->
        <section class="card">
          <div class="card-header blue">
            <span>í™˜ì ì •ë³´</span>

            <!-- ìƒì„¸ë³´ê¸° ëª¨ë“œ: ìˆ˜ì • ë²„íŠ¼ -->
            <button class="btn-xs" th:if="${mode == 'detail'}">ìˆ˜ì •</button>
            <!-- ë“±ë¡ ëª¨ë“œ: ë“±ë¡ ë²„íŠ¼ -->
            <button class="btn-xs" th:if="${mode == 'register'}">ë“±ë¡</button>
          </div>
          <div class="card-body">
            <!-- í™˜ìID -->
            <div class="form-row">
              <label>í™˜ìID</label>
              <input type="text" th:if="${mode == 'detail'}"
                     th:value="${selected != null ? selected.patientId : ''}" readonly/>
              <input type="text" th:if="${mode == 'register'}" name="patientId"/>
            </div>

            <!-- í™˜ìëª… -->
            <div class="form-row">
              <label>í™˜ìëª…</label>
              <input type="text" th:if="${mode == 'detail'}"
                     th:value="${selected != null ? selected.name : ''}" readonly/>
              <input type="text" th:if="${mode == 'register'}" name="name"/>
            </div>

            <!-- ì„±ë³„ -->
            <div class="form-row">
              <label>ì„±ë³„</label>
              <input type="text" th:if="${mode == 'detail'}"
                     th:value="${selected != null ? selected.gender : ''}" readonly/>
              <select th:if="${mode == 'register'}" name="gender"
                      style="flex:1; padding:4px 6px; border:1px solid #cbd2e1; border-radius:3px;">
                <option value="">ì„ íƒ</option>
                <option value="M">ë‚¨</option>
                <option value="F">ì—¬</option>
              </select>
            </div>

            <!-- ìƒë…„ì›”ì¼ -->
            <div class="form-row">
              <label>ìƒë…„ì›”ì¼</label>
              <input type="text" th:if="${mode == 'detail'}"
                     th:value="${selected != null ? selected.birth : ''}" readonly/>
              <input type="text" th:if="${mode == 'register'}" name="birth"/>
            </div>

            <!-- ì „í™”ë²ˆí˜¸ -->
            <div class="form-row">
              <label>ì „í™”ë²ˆí˜¸</label>
              <input type="text" th:if="${mode == 'detail'}"
                     th:value="${selected != null ? selected.phone : ''}" readonly/>
              <input type="text" th:if="${mode == 'register'}" name="phone"/>
            </div>

            <!-- ì—°ë½ì²˜ -->
            <div class="form-row">
              <label>ì—°ë½ì²˜</label>
              <input type="text" th:if="${mode == 'detail'}"
                     th:value="${selected != null ? selected.subPhone : ''}" readonly/>
              <input type="text" th:if="${mode == 'register'}" name="subPhone"/>
            </div>

            <!-- ì£¼ì†Œ1 -->
            <div class="form-row">
              <label>ì£¼ì†Œ1</label>
              <input type="text" th:if="${mode == 'detail'}"
                     th:value="${selected != null ? selected.address1 : ''}" readonly/>
              <input type="text" th:if="${mode == 'register'}" name="address1"/>
            </div>

            <!-- ì£¼ì†Œ2 -->
            <div class="form-row">
              <label>ì£¼ì†Œ2</label>
              <input type="text" th:if="${mode == 'detail'}"
                     th:value="${selected != null ? selected.address2 : ''}" readonly/>
              <input type="text" th:if="${mode == 'register'}" name="address2"/>
            </div>

            <!-- ë©”ëª¨ -->
            <div class="form-row">
              <label>ë©”ëª¨</label>
              <input type="text" th:if="${mode == 'detail'}"
                     th:value="${selected != null ? selected.memo : ''}" readonly/>
              <input type="text" th:if="${mode == 'register'}" name="memo"/>
            </div>

            <!-- ì´ë©”ì¼ -->
            <div class="form-row">
              <label>ì´ë©”ì¼</label>
              <input type="email" th:if="${mode == 'detail'}"
                     th:value="${selected != null ? selected.email : ''}" readonly/>
              <input type="email" th:if="${mode == 'register'}" name="email"/>
            </div>
          </div>
        </section>

        <!-- ì˜ˆì•½/ì ‘ìˆ˜ ë°”ë¡œê°€ê¸° -->
        <div class="quick-buttons">
          <button class="btn-small">ì˜ˆì•½ ë°”ë¡œê°€ê¸°</button>
          <button class="btn-small">ì ‘ìˆ˜ ë°”ë¡œê°€ê¸°</button>
        </div>

        <!-- ì˜ë¢° history ì •ë³´ -->
        <section class="card">
          <div class="card-header">
            ì˜ë¢° history ì •ë³´
          </div>
          <div class="card-body">
            <table>
              <thead>
              <tr>
                <th>ë‚´ì›ì¼ì</th>
                <th>ì§„ë£Œì˜ì‚¬</th>
                <th>ì´ˆ/ì¬ì§„</th>
                <th>ì¦ìƒ</th>
              </tr>
              </thead>
              <tbody>
              <tr th:each="h : ${outHistories != null ? outHistories : {}}">
                <td th:text="${h.visitDate}"></td>
                <td th:text="${h.doctorName}"></td>
                <td th:text="${h.firstOrReturn}"></td>
                <td th:text="${h.symptom}"></td>
              </tr>
              <tr th:if="${outHistories == null or #lists.isEmpty(outHistories)}">
                <td colspan="4">&nbsp;</td>
              </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- ì…ì› history ì •ë³´ -->
        <section class="card">
          <div class="card-header">
            ì…ì› history ì •ë³´
          </div>
          <div class="card-body">
            <table>
              <thead>
              <tr>
                <th>ì…ì›ì¼ì</th>
                <th>í‡´ì›ì¼ì</th>
                <th>ì§„ë£Œì˜ì‚¬</th>
                <th>ì¦ìƒ</th>
              </tr>
              </thead>
              <tbody>
              <tr th:each="h : ${inHistories != null ? inHistories : {}}">
                <td th:text="${h.admissionDate}"></td>
                <td th:text="${h.dischargeDate}"></td>
                <td th:text="${h.doctorName}"></td>
                <td th:text="${h.symptom}"></td>
              </tr>
              <tr th:if="${inHistories == null or #lists.isEmpty(inHistories)}">
                <td colspan="4">&nbsp;</td>
              </tr>
              </tbody>
            </table>
          </div>
        </section>
      </section>
    </div>
  </div>

</div>
</body>
</html>
